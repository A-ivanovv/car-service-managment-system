<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ customer.customer_name }} - Автосервиз</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{% url 'dashboard' %}">
                <i class="fas fa-wrench me-2"></i>Автосервиз
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="{% url 'dashboard' %}">
                    <i class="fas fa-home me-1"></i>Начало
                </a>
                <a class="nav-link" href="{% url 'klienti' %}">
                    <i class="fas fa-users me-1"></i>Клиенти
                </a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-md-8">
                <h2><i class="fas fa-user me-2"></i>{{ customer.customer_name }}</h2>
                <p class="text-muted">ID: {{ customer.id }}</p>
            </div>
            <div class="col-md-4 text-end">
                <a href="{% url 'customer_edit' customer.pk %}" class="btn btn-warning me-2">
                    <i class="fas fa-edit me-1"></i>Редактирай
                </a>
                <a href="{% url 'customer_delete' customer.pk %}" class="btn btn-danger me-2">
                    <i class="fas fa-trash me-1"></i>Изтрий
                </a>
                <a href="{% url 'klienti' %}" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-1"></i>Назад
                </a>
            </div>
        </div>

        <!-- Status badges -->
        <div class="row mb-4">
            <div class="col-12">
                {% if customer.active %}
                    <span class="badge bg-success fs-6 me-2">Активен</span>
                {% else %}
                    <span class="badge bg-secondary fs-6 me-2">Неактивен</span>
                {% endif %}
                {% if customer.customer %}
                    <span class="badge bg-primary fs-6 me-2">Клиент</span>
                {% endif %}
                {% if customer.supplier %}
                    <span class="badge bg-warning fs-6 me-2">Доставчик</span>
                {% endif %}
                {% if customer.include %}
                    <span class="badge bg-info fs-6 me-2">Включен</span>
                {% endif %}
            </div>
        </div>

        <div class="row">
            <!-- Basic Information -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-info-circle me-2"></i>Основна информация</h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Номер:</strong></td>
                                <td>{{ customer.id }}</td>
                            </tr>
                            <tr>
                                <td><strong>Име:</strong></td>
                                <td>{{ customer.customer_name }}</td>
                            </tr>
                            <tr>
                                <td><strong>МОЛ:</strong></td>
                                <td>{{ customer.customer_mol|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Тип документ:</strong></td>
                                <td>{{ customer.customer_doctype|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Контакт:</strong></td>
                                <td>{{ customer.contact|default:"-" }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Address Information -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-map-marker-alt me-2"></i>Адресна информация</h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Адрес 1:</strong></td>
                                <td>{{ customer.customer_address_1|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Адрес 2:</strong></td>
                                <td>{{ customer.customer_address_2|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Адрес за живеене 1:</strong></td>
                                <td>{{ customer.res_address_1|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Адрес за живеене 2:</strong></td>
                                <td>{{ customer.res_address_2|default:"-" }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Contact Information -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-phone me-2"></i>Контактна информация</h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Телефон:</strong></td>
                                <td>
                                    {% if customer.telno %}
                                        <a href="tel:{{ customer.telno }}" class="text-decoration-none">
                                            <i class="fas fa-phone me-1"></i>{{ customer.telno }}
                                        </a>
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Факс:</strong></td>
                                <td>{{ customer.faxno|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Имейл:</strong></td>
                                <td>
                                    {% if customer.email %}
                                        <a href="mailto:{{ customer.email }}" class="text-decoration-none">
                                            <i class="fas fa-envelope me-1"></i>{{ customer.email }}
                                        </a>
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Business Information -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-building me-2"></i>Бизнес информация</h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>ДДС номер:</strong></td>
                                <td>{{ customer.customer_taxno|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>БУЛСТАТ:</strong></td>
                                <td>{{ customer.customer_bulstat|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>БУЛСТАТ буква:</strong></td>
                                <td>{{ customer.bulstatletter|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Партида:</strong></td>
                                <td>{{ customer.partida|default:"-" }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Receiver Information -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-user-tie me-2"></i>Информация за получател</h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Получател:</strong></td>
                                <td>{{ customer.receiver|default:"-" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Детайли за получател:</strong></td>
                                <td>{{ customer.receiver_details|default:"-" }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <!-- System Information -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-cog me-2"></i>Системна информация</h5>
                    </div>
                    <div class="card-body">
                        <table class="table table-borderless">
                            <tr>
                                <td><strong>Дата на влизане:</strong></td>
                                <td>
                                    {% if customer.eidate %}
                                        {{ customer.eidate|date:"d.m.Y H:i" }}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            </tr>
                            <tr>
                                <td><strong>Създаден на:</strong></td>
                                <td>{{ customer.created_at|date:"d.m.Y H:i" }}</td>
                            </tr>
                            <tr>
                                <td><strong>Обновен на:</strong></td>
                                <td>{{ customer.updated_at|date:"d.m.Y H:i" }}</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cars Section -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0"><i class="fas fa-car me-2"></i>Коли ({{ cars.count }})</h5>
                        <a href="{% url 'customer_edit' customer.pk %}" class="btn btn-primary btn-sm">
                            <i class="fas fa-edit me-1"></i>Редактирай
                        </a>
                    </div>
                    <div class="card-body">
                        {% if cars %}
                            <div class="row">
                                {% for car in cars %}
                                    <div class="col-md-6 mb-3">
                                        <div class="card border">
                                            <div class="card-body">
                                                <h6 class="card-title">
                                                    <i class="fas fa-car me-2"></i>{{ car.brand_model }}
                                                    {% if car.is_active %}
                                                        <span class="badge bg-success ms-2">Активна</span>
                                                    {% else %}
                                                        <span class="badge bg-secondary ms-2">Неактивна</span>
                                                    {% endif %}
                                                </h6>
                                                <div class="row">
                                                    {% if car.vin %}
                                                        <div class="col-6">
                                                            <small class="text-muted">VIN:</small><br>
                                                            <strong>{{ car.vin }}</strong>
                                                        </div>
                                                    {% endif %}
                                                    {% if car.plate_number %}
                                                        <div class="col-6">
                                                            <small class="text-muted">Рег. номер:</small><br>
                                                            <strong>{{ car.plate_number }}</strong>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                                <div class="row mt-2">
                                                    {% if car.year %}
                                                        <div class="col-4">
                                                            <small class="text-muted">Година:</small><br>
                                                            <strong>{{ car.year }}</strong>
                                                        </div>
                                                    {% endif %}
                                                    {% if car.color %}
                                                        <div class="col-4">
                                                            <small class="text-muted">Цвят:</small><br>
                                                            <strong>{{ car.color }}</strong>
                                                        </div>
                                                    {% endif %}
                                                    {% if car.engine_number %}
                                                        <div class="col-4">
                                                            <small class="text-muted">Двигател:</small><br>
                                                            <strong>{{ car.engine_number }}</strong>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        {% else %}
                            <div class="text-center text-muted py-4">
                                <i class="fas fa-car fa-3x mb-3"></i>
                                <p>Няма регистрирани коли за този клиент.</p>
                                <a href="{% url 'customer_edit' customer.pk %}" class="btn btn-primary">
                                    <i class="fas fa-plus me-1"></i>Добави кола
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
